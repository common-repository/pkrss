(function(a,b){jPlayerPlaylist=function(e,f,d){var c=this;this.current=0;this.loop=false;this.shuffled=false;this.removing=false;this.cssSelector=a.extend({},this._cssSelector,e);this.options=a.extend(true,{},this._options,d);this.playlist=[];this.original=[];this._initPlaylist(f);this.cssSelector.title=this.cssSelector.cssSelectorAncestor+" .jp-title";this.cssSelector.playlist=this.cssSelector.cssSelectorAncestor+" .jp-playlist";this.cssSelector.next=this.cssSelector.cssSelectorAncestor+" .jp-next";this.cssSelector.previous=this.cssSelector.cssSelectorAncestor+" .jp-previous";this.cssSelector.shuffle=this.cssSelector.cssSelectorAncestor+" .jp-shuffle";this.cssSelector.shuffleOff=this.cssSelector.cssSelectorAncestor+" .jp-shuffle-off";this.options.cssSelectorAncestor=this.cssSelector.cssSelectorAncestor;this.options.repeat=function(g){c.loop=g.jPlayer.jp_options.loop};a(this.cssSelector.previous).click(function(){c.previous();a(this).blur();return false});a(this.cssSelector.next).click(function(){c.next();a(this).blur();return false});a(this.cssSelector.shuffle).click(function(){c.shuffle(true);return false});a(this.cssSelector.shuffleOff).click(function(){c.shuffle(false);return false}).hide();if(!this.options.fullScreen){a(this.cssSelector.title).hide()}a(this.cssSelector.playlist+" ul").empty();this._createItemHandlers();this._initByJplayer()};jPlayerPlaylist.prototype={_cssSelector:{jPlayer:"#jquery_jplayer_1",cssSelectorAncestor:"#jp_container_1"},_options:{playlistOptions:{autoPlay:false,loopOnPrevious:false,shuffleOnLoop:true,enableRemoveControls:false,displayTime:"slow",addTime:"fast",removeTime:"fast",shuffleTime:"slow",itemClass:"jp-playlist-item",freeGroupClass:"jp-free-media",freeItemClass:"jp-playlist-item-free",removeItemClass:"jp-playlist-item-remove"}},option:function(c,d){if(d===b){return this.options.playlistOptions[c]}this.options.playlistOptions[c]=d;switch(c){case"enableRemoveControls":this._updateControls();break;case"itemClass":case"freeGroupClass":case"freeItemClass":case"removeItemClass":this._refresh(true);this._createItemHandlers();break}return this},_init:function(){var c=this;this._refresh(function(){if(c.options.playlistOptions.autoPlay){c.play(c.current)}else{c.select(c.current)}})},_initPlaylist:function(c){this.current=0;this.shuffled=false;this.removing=false;this.original=a.extend(true,[],c);this._originalPlaylist()},_originalPlaylist:function(){var c=this;this.playlist=[];a.each(this.original,function(e,d){c.playlist[e]=c.original[e]})},_refresh:function(d){var c=this;if(d&&!a.isFunction(d)){a(this.cssSelector.playlist+" ul").empty();a.each(this.playlist,function(g,f){a(c.cssSelector.playlist+" ul").append(c._createListItem(c.playlist[g]))});this._updateControls()}else{var e=a(this.cssSelector.playlist+" ul").children().length?this.options.playlistOptions.displayTime:0;a(this.cssSelector.playlist+" ul").slideUp(e,function(){var f=a(this);a(this).empty();a.each(c.playlist,function(h,g){f.append(c._createListItem(c.playlist[h]))});c._updateControls();if(a.isFunction(d)){d()}if(c.playlist.length){a(this).slideDown(c.options.playlistOptions.displayTime)}else{a(this).show()}})}},_createListItem:function(e){var c=this;var d="<li><div>";d+="<a href='javascript:;' class='"+this.options.playlistOptions.removeItemClass+"'>&times;</a>";if(e.free){var f=true;d+="<span class='"+this.options.playlistOptions.freeGroupClass+"'>(";a.each(e,function(h,g){if(a.jPlayer.prototype.format[h]){if(f){f=false}else{d+=" | "}d+="<a class='"+c.options.playlistOptions.freeItemClass+"' href='"+g+"' tabindex='1'>"+h+"</a>"}});d+=")</span>"}d+="<a href='javascript:;' class='"+this.options.playlistOptions.itemClass+"' tabindex='1'>"+e.title+(e.artist?" <span class='jp-artist'>by "+e.artist+"</span>":"")+"</a>";d+="</div></li>";return d},_createItemHandlers:function(){var c=this;a(this.cssSelector.playlist+" a."+this.options.playlistOptions.itemClass).unbind("click").bind("click",function(){var d=a(this).parent().parent().index();if(c.current!==d){c.play(d)}else{pkrssspeak.speakitem(c.curitemid())}a(this).blur();return false});a(c.cssSelector.playlist+" a."+this.options.playlistOptions.freeItemClass).unbind("click").bind("click",function(){a(this).parent().parent().find("."+c.options.playlistOptions.itemClass).click();a(this).blur();return false});a(c.cssSelector.playlist+" a."+this.options.playlistOptions.removeItemClass).unbind("click").bind("click",function(){var d=a(this).parent().parent().index();c.remove(d);a(this).blur();return false})},_updateControls:function(){if(this.options.playlistOptions.enableRemoveControls){a(this.cssSelector.playlist+" ."+this.options.playlistOptions.removeItemClass).show()}else{a(this.cssSelector.playlist+" ."+this.options.playlistOptions.removeItemClass).hide()}if(this.shuffled){a(this.cssSelector.shuffleOff).show();a(this.cssSelector.shuffle).hide()}else{a(this.cssSelector.shuffleOff).hide();a(this.cssSelector.shuffle).show()}},_highlight:function(c){if(this.playlist.length&&c!==b){a(this.cssSelector.playlist+" .jp-playlist-current").removeClass("jp-playlist-current");a(this.cssSelector.playlist+" li:nth-child("+(c+1)+")").addClass("jp-playlist-current").find(".jp-playlist-item").addClass("jp-playlist-current");a(this.cssSelector.title+" li").html(this.playlist[c].title+(this.playlist[c].artist?" <span class='jp-artist'>by "+this.playlist[c].artist+"</span>":""))}},setPlaylist:function(c){this._initPlaylist(c);this._init()},add:function(c,d){a(this.cssSelector.playlist+" ul").append(this._createListItem(c)).find("li:last-child").hide().slideDown(this.options.playlistOptions.addTime);this._updateControls();this.original.push(c);this.playlist.push(c);if(d){this.play(this.playlist.length-1)}else{if(this.original.length===1){this.select(0)}}},remove:function(d){var c=this;if(d===b){this._initPlaylist([]);this._refresh(function(){pkrssspeak.stop()});return true}else{if(this.removing){return false}else{d=(d<0)?c.original.length+d:d;if(0<=d&&d<this.playlist.length){this.removing=true;a(this.cssSelector.playlist+" li:nth-child("+(d+1)+")").slideUp(this.options.playlistOptions.removeTime,function(){a(this).remove();if(c.shuffled){var e=c.playlist[d];a.each(c.original,function(g,f){if(c.original[g]===e){c.original.splice(g,1);return false}});c.playlist.splice(d,1)}else{c.original.splice(d,1);c.playlist.splice(d,1)}if(c.original.length){if(d===c.current){c.current=(d<c.original.length)?c.current:c.original.length-1;c.select(c.current)}else{if(d<c.current){c.current--}}}else{pkrssspeak.stop();c.current=0;c.shuffled=false;c._updateControls()}c.removing=false})}return true}}},select:function(c){c=(c<0)?this.original.length+c:c;if(0<=c&&c<this.playlist.length){this.current=c;this._highlight(c)}else{this.current=0}},play:function(c){c=(c<0)?this.original.length+c:c;if(0<=c&&c<this.playlist.length){if(this.playlist.length){this.select(c)}}else{if(c===b){}}pkrssspeak.speakitem(this.curitemid())},curitemid:function(){if(this.current<this.playlist.length){return this.playlist[this.current].artist}return 0},pause:function(){pkrssspeak.pause()},next:function(){var c=(this.current+1<this.playlist.length)?this.current+1:0;if(this.loop){if(c===0&&this.shuffled&&this.options.playlistOptions.shuffleOnLoop&&this.playlist.length>1){this.shuffle(true,true)}else{this.play(c)}}else{if(c>0){this.play(c)}}},previous:function(){var c=(this.current-1>=0)?this.current-1:this.playlist.length-1;if(this.loop&&this.options.playlistOptions.loopOnPrevious||c<this.playlist.length-1){this.play(c)}},shuffle:function(c,e){var d=this;if(c===b){c=!this.shuffled}if(c||c!==this.shuffled){a(this.cssSelector.playlist+" ul").slideUp(this.options.playlistOptions.shuffleTime,function(){d.shuffled=c;if(c){d.playlist.sort(function(){return 0.5-Math.random()})}else{d._originalPlaylist()}d._refresh(true);if(e){d.play(0)}else{d.select(0)}a(this).slideDown(d.options.playlistOptions.shuffleTime)})}},_initByJplayer:function(){this.css={};this.css.cs={};this.css.jq={};this.jp_options=a.extend(true,{},this.jp_options,this.options);this.element=a(this.jp_options.cssSelectorAncestor);this.jp_internal.domNode=this.element.get(0);this.jp_internal.self=a.extend({},{id:this.element.attr("id"),jq:this.element});this._cssSelectorAncestor(this.jp_options.cssSelector);this._updateInterface();this._updateButtons(false);this._updateAutohide();this._updateVolume(this.jp_options.volume);this._updateMute(this.jp_options.muted);this._addHtmlEventListeners()},_updateButtons:function(c){if(c!==b){this.jp_status.paused=!c;if(this.css.jq.jp_play.length&&this.css.jq.jp_pause.length){if(c){this.css.jq.jp_play.hide();this.css.jq.jp_pause.show()}else{this.css.jq.jp_play.show();this.css.jq.jp_pause.hide()}}}if(this.css.jq.jp_repeat.length&&this.css.jq.jp_repeatOff.length){if(this.jp_options.loop){this.css.jq.jp_repeat.hide();this.css.jq.jp_repeatOff.show()}else{this.css.jq.jp_repeat.show();this.css.jq.jp_repeatOff.hide()}}},_updateInterface:function(){if(this.css.jq.jp_seekBar.length){this.css.jq.jp_seekBar.width(this.jp_status.seekPercent+"%")}if(this.css.jq.jp_playBar.length){this.css.jq.jp_playBar.width(this.jp_status.currentPercentRelative+"%")}if(this.css.jq.jp_currentTime.length){this.css.jq.jp_currentTime.text(this._convertTime(this.jp_status.currentTime))}if(this.css.jq.jp_duration.length){this.css.jq.jp_duration.text(this._convertTime(this.jp_status.duration))}},_updateAutohide:function(){var c=this,g="mousemove.jPlayer",f=".jPlayerAutohide",d=g+f,e=function(){c.css.jq.jp_gui.fadeIn(c.jp_options.autohide.fadeIn,function(){clearTimeout(c.jp_internal.autohideId);c.jp_internal.autohideId=setTimeout(function(){c.css.jq.jp_gui.fadeOut(c.jp_options.autohide.fadeOut)},c.jp_options.autohide.hold)})};if(this.css.jq.jp_gui.length){this.css.jq.jp_gui.stop(true,true);clearTimeout(this.jp_internal.autohideId);this.element.unbind(f);this.css.jq.jp_gui.unbind(f);if(!this.jp_status.nativeVideoControls){if(this.jp_options.fullScreen&&this.jp_options.autohide.full||!this.jp_options.fullScreen&&this.jp_options.autohide.restored){this.element.bind(d,e);this.css.jq.jp_gui.bind(d,e);this.css.jq.jp_gui.hide()}else{this.css.jq.jp_gui.show()}}else{this.css.jq.jp_gui.hide()}}},jp_play:function(c){pkrssspeak.speakitem(this.curitemid())},jp_pause:function(c){pkrssspeak.pause()},jp_stop:function(){pkrssspeak.stop()},jp_playHead:function(c){c=this._limitValue(c,0,100)},_muted:function(c){this.jp_options.muted=c;pkrssspeak.mute(c);this._updateMute(c);this._updateVolume(this.jp_options.volume)},jp_mute:function(c){c=c===b?true:!!c;this._muted(c)},jp_unmute:function(c){c=c===b?true:!!c;this._muted(!c)},_updateMute:function(c){if(c===b){c=this.jp_options.muted}if(this.css.jq.jp_mute.length&&this.css.jq.jp_unmute.length){if(this.jp_status.noVolume){this.css.jq.jp_mute.hide();this.css.jq.jp_unmute.hide()}else{if(c){this.css.jq.jp_mute.hide();this.css.jq.jp_unmute.show()}else{this.css.jq.jp_mute.show();this.css.jq.jp_unmute.hide()}}}},_timeFormat:{showHour:false,showMin:true,showSec:true,padHour:false,padMin:true,padSec:true,sepHour:":",sepMin:":",sepSec:""},_convertTime:function(k){var g=new Date(k*1000);var e=g.getUTCHours();var f=g.getUTCMinutes();var h=g.getUTCSeconds();var d=this._timeFormat;var j=(d.padHour&&e<10)?"0"+e:e;var i=(d.padMin&&f<10)?"0"+f:f;var c=(d.padSec&&h<10)?"0"+h:h;return((d.showHour)?j+d.sepHour:"")+((d.showMin)?i+d.sepMin:"")+((d.showSec)?c+d.sepSec:"")},_limitValue:function(e,d,c){return(e<d)?d:((e>c)?c:e)},jp_volume:function(c){c=this._limitValue(c,0,1);this.jp_options.volume=c;pkrssspeak.volume(c);this._updateVolume(c)},jp_volumeBar:function(g){if(this.css.jq.jp_volumeBar.length){var i=this.css.jq.jp_volumeBar.offset(),c=g.pageX-i.left,d=this.css.jq.jp_volumeBar.width(),j=this.css.jq.jp_volumeBar.height()-g.pageY+i.top,f=this.css.jq.jp_volumeBar.height();if(this.jp_options.verticalVolume){this.jp_volume(j/f)}else{this.jp_volume(c/d)}}if(this.jp_options.muted){this._muted(false)}},jp_volumeBarValue:function(c){this.jp_volumeBar(c)},_addHtmlEventListeners:function(d){var c=this;pkrssspeak.event.bind(pkrssspeak.event.eventType.progress,function(){c._updateInterface()},false);pkrssspeak.event.bind(pkrssspeak.event.eventType.play,function(){c._updateButtons(true)},false);pkrssspeak.event.bind(pkrssspeak.event.eventType.playing,function(){c._updateButtons(true)},false);pkrssspeak.event.bind(pkrssspeak.event.eventType.pause,function(){c._updateButtons(false)},false);pkrssspeak.event.bind(pkrssspeak.event.eventType.ended,function(){c._updateButtons(false);c._updateInterface();c.next()},false)},_updateVolume:function(c){if(c===b){c=this.jp_options.volume}c=this.jp_options.muted?0:c;if(this.jp_status.noVolume){if(this.css.jq.jp_volumeBar.length){this.css.jq.jp_volumeBar.hide()}if(this.css.jq.jp_volumeBarValue.length){this.css.jq.jp_volumeBarValue.hide()}if(this.css.jq.jp_volumeMax.length){this.css.jq.jp_volumeMax.hide()}}else{if(this.css.jq.jp_volumeBar.length){this.css.jq.jp_volumeBar.show()}if(this.css.jq.jp_volumeBarValue.length){this.css.jq.jp_volumeBarValue.show();this.css.jq.jp_volumeBarValue[this.jp_options.verticalVolume?"height":"width"]((c*100)+"%")}if(this.css.jq.jp_volumeMax.length){this.css.jq.jp_volumeMax.show()}}},jp_volumeMax:function(){this.volume(1);if(this.jp_options.muted){this._muted(false)}},jp_seekBar:function(g){if(this.css.jq.jp_seekBar){var h=this.css.jq.jp_seekBar.offset();var c=g.pageX-h.left;var d=this.css.jq.jp_seekBar.width();var f=100*c/d;this.jp_playHead(f)}},jp_playBar:function(c){this.jp_seekBar(c)},jp_repeat:function(){this._loop(true)},jp_repeatOff:function(){this._loop(false)},_loop:function(c){if(this.jp_options.loop!==c){this.jp_options.loop=c;this._updateButtons()}},jp_currentTime:function(){},jp_duration:function(){},jp_gui:function(){},jp_noSolution:function(){},jp_internal:{ready:false},jp_status:{src:"",media:{},paused:true,format:{},formatType:"",waitForPlay:true,waitForLoad:true,srcSet:false,video:false,seekPercent:0,currentPercentRelative:0,currentPercentAbsolute:0,currentTime:0,duration:0,readyState:0,networkState:0,playbackRate:1,ended:0},jp_options:{cssSelectorAncestor:"#jp_container_1",cssSelector:{jp_play:".jp-play",jp_pause:".jp-pause",jp_stop:".jp-stop",jp_seekBar:".jp-seek-bar",jp_playBar:".jp-play-bar",jp_mute:".jp-mute",jp_unmute:".jp-unmute",jp_volumeBar:".jp-volume-bar",jp_volumeBarValue:".jp-volume-bar-value",jp_volumeMax:".jp-volume-max",jp_currentTime:".jp-current-time",jp_duration:".jp-duration",jp_repeat:".jp-repeat",jp_repeatOff:".jp-repeat-off",jp_gui:".jp-gui",jp_noSolution:".jp-no-solution"},preload:"metadata",volume:0.8,muted:false,wmode:"opaque",backgroundColor:"#000000",fullScreen:false,autohide:{restored:false,full:true,fadeIn:200,fadeOut:600,hold:1000},loop:false,repeat:function(c){if(c.jPlayer.options.loop){a(this).unbind(".jPlayerRepeat").bind(a.jPlayer.event.ended+".jPlayer.jPlayerRepeat",function(){a(this).jPlayer("play")})}else{a(this).unbind(".jPlayerRepeat")}},nativeVideoControls:{},noFullScreen:{msie:/msie [0-6]/,ipad:/ipad.*?os [0-4]/,iphone:/iphone/,ipod:/ipod/,android_pad:/android [0-3](?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,webos:/webos/},noVolume:{ipad:/ipad/,iphone:/iphone/,ipod:/ipod/,android_pad:/android(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,webos:/webos/,playbook:/playbook/},verticalVolume:false,idPrefix:"jp",noConflict:"jQuery",emulateHtml:false,errorAlerts:false,warningAlerts:false},_cssSelectorAncestor:function(d){var c=this;a.each(d,function(e,f){c._cssSelector(e,f)})},_cssSelector:function(e,f){var c=this;if(typeof f==="string"){if(this.jp_options.cssSelector[e]){if(this.css.jq[e]&&this.css.jq[e].length){this.css.jq[e].unbind(".jPlayer")}this.jp_options.cssSelector[e]=f;this.css.cs[e]=this.jp_options.cssSelectorAncestor+" "+f;if(f){this.css.jq[e]=a(this.css.cs[e])}else{this.css.jq[e]=[]}if(this.css.jq[e].length){var d=function(g){c[e](g);a(this).blur();return false};this.css.jq[e].bind("click.jPlayer",d)}}}}}})(jQuery);