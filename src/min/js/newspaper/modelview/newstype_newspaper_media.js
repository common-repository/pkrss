pkrss.cls.newstype_newspaper_media=function(){pkrss.cls.newstype_module_base.call(this);this.name="media";this.text="Media news";this.actived=false;this.model=null;this.container=null;this.containerid="medianews_info";this.oldparent=null};pkrss.cls.newstype_newspaper_media.prototype.init=function(c,a){if(this.model){return}this.model=c;this.container=a;var e='<div id="'+this.containerid+'">	</div>	';pkrss.q("#plugin_container").append(e);var d="pkrss.q.fn.media";if(pkrss.getObjFromNamespace(d)){this.init2();return}var b=this;pkrss.utils.html.loadPlateformJs([{ns:"jQuery.metadata",src:pkrss.ajax.pkurlresurlpath+"js/third/jquery-metadata/jquery.metadata.js"},{ns:d,src:pkrss.ajax.pkurlresurlpath+"js/third/jquery-media/jquery.media.js",depends:["jQuery.metadata"]},{ns:"Masonry",src:pkrss.ajax.pkurlresurlpath+"js/third/jquery-masonry/jquery.masonry.all.js",depends:[d]}],function(f){if(!f){return}b.init2();b=null;changenow=null})};pkrss.cls.newstype_newspaper_media.prototype.init2=function(){this.msnry=new Masonry(this.container[0],{itemSelector:".box"});if(this.actived){this.loadrssitem(false)}pkrss.model.newstype.module.addmodule(this);pkrss.model.newstype.module.changemodule(this.name)};pkrss.cls.newstype_newspaper_media.prototype.onActive=function(){this.actived=true;if(!this.model){return}pkrss.ui.hideLoading();var a=document.getElementById("container");a.style.height="";var b=pkrss.q("#"+this.containerid);if(!this.oldparent){this.oldparent=b.parent()}this.container.append(b);if(pkrss.getObjFromNamespace("jQuery.fn.media")){this.loadrssitem(false)}pkrss.event.bind(pkrss.model.event.tableChanged,this.onCatalogTableChanged)};pkrss.cls.newstype_newspaper_media.prototype.onDeactive=function(){this.actived=false;var a=pkrss.q("#"+this.containerid);this.oldparent.append(a);pkrss.q("#"+this.containerid).empty();pkrss.event.unbind(pkrss.model.event.tableChanged,this.onCatalogTableChanged)};pkrss.cls.newstype_newspaper_media.prototype.onCatalogTableChanged=function(){pkrss.model.newstype.newspaper.media.loadrssitem(false)};pkrss.cls.newstype_newspaper_media.prototype.loadrssitem=function(a){if(!this.actived){return}if(!a){pkrss.q("#"+this.containerid).empty()}var b=this;this.model.loadPageData(function(c){if(b.actived){b.onHandle(c)}b=null},!a,"456")};pkrss.cls.newstype_newspaper_media.prototype.onHandle=function(f){if(f&&f.length){var d,h,e;var c="";var g="media_"+pkrss.uniqueid();for(var b in f){d=f[b];if(d.media&&d.media.length){for(var a in d.media){h=d.media[a];c+='<a class="box '+g+" {width:"+h.width+", height:"+h.height+'}" href="'+h.url+'">'+d.title+"</a>"}}}c=pkrss.q(c);pkrss.q("#"+this.containerid).append(c).find("a."+g).media();this.msnry.appended(c);this.msnry.layout()}};pkrss.define("pkrss.model.newstype.newspaper",{media:new pkrss.cls.newstype_newspaper_media()});