pkrss.cls.newstype_plugincontainer_tts=function(){this.playlist=null;this.cur_navlist_idex=0;this.userrsslist=[];this.init()};pkrss.cls.newstype_plugincontainer_tts.prototype.onJsLoaded=function(){if(!pkrss.profile.usersetting.locale2tts){pkrss.profile.usersetting.locale2tts={}}pkrss.q('<div id="content-pane-playerlist-item">	<div id="player_radio_container">	</div>	<div id="jquery_jplayer_rssradio" class="jp-jplayer"></div>	<div id="jp_container_rssradio" class="jp-audio">		<div class="jp-type-playlist">			<div class="jp-gui jp-interface">				<ul class="jp-controls">					<li><a href="#" class="jp-previous" tabindex="1">previous</a></li>					<li><a href="#" class="jp-play" tabindex="1">play</a></li>					<li><a href="#" class="jp-pause" tabindex="1">pause</a></li>					<li><a href="#" class="jp-next" tabindex="1">next</a></li>					<li><a href="#" class="jp-stop" tabindex="1">stop</a></li>					<li><a href="#" class="jp-mute" tabindex="1">mute</a></li>					<li><a href="#" class="jp-unmute" tabindex="1">unmute</a></li>				</ul>				<div class="jp-progress">					<div class="jp-seek-bar">						<div class="jp-play-bar"></div>					</div>				</div>				<div class="jp-volume-bar">					<div class="jp-volume-bar-value"></div>				</div>				<div class="jp-time-holder">					<div class="jp-current-time"></div>					<div class="jp-duration"></div>				</div>			</div>			<div class="jp-more">					<a href="#" onclick="pkrss.model.newstype.plugincontainer.tts.switchListTab(0);" id="navlist_0" class="list list_sel" tabindex="1" style="left:0px">SpeakList</a>					<a href="#" onclick="pkrss.model.newstype.plugincontainer.tts.switchListTab(1);" id="navlist_1" class="list" tabindex="2" title="Setting for pkrss tts" style="left:103px">Setting</a>					<a href="#" id="jpbtn_quickremove" class="list" tabindex="3" title="batch quick remove" style="right:5px;top:2px;border-bottom:1px solid #009be3; ">Quick Remove</a>					<a href="#" id="jpbtn_quickadd" class="list" tabindex="2" title="batch quick add" style="right:105px;top:2px;border-bottom:1px solid #009be3; ">Quick Add</a>				</div>			<div id="myplaylist" class="jp-playlist jp-pkpanel-0">				<ul>					<li></li>				</ul>			</div>			<div id="pklistoptionpane" class="jp-playlist jp-pkpanel-1" style="display:none">				<div data-role="collapsible" data-theme="a" data-content-theme="b">				   <h3 id="rssvoicelabel" >Choose RSS voice:System+Internet</h3>				   	<fieldset id="rssvoicecontainer" data-role="controlgroup" data-mini="true">						</fieldset>				</div>				<div data-role="collapsible" data-theme="a" data-content-theme="b">				   <div data-role="fieldcontain">					   <label for="settingPlaySupportNotificationSelect" id="settingPlaySupportNotificationSelectLabel">Notification on speak:</label>					   <select name="settingPlaySupportNotificationSelect" id="settingPlaySupportNotificationSelect" data-role="slider">								<option value="off">Off</option>								<option value="on">On</option>							</select>				   </div>				</div>			</div>		</div>	</div></div>').appendTo(pkrss.q("#div_pannel > #div_playlist"));if((typeof(pkrss.utils.tts)!="undefined")&&pkrss.utils.tts){pkrss.utils.tts.init()}this.onRssLangChagned();this.playlist=new jPlayerPlaylist({jPlayer:"#jquery_jplayer_rssradio",cssSelectorAncestor:"#jp_container_rssradio"},[],{playlistOptions:{autoPlay:true,enableRemoveControls:true,loopOnPrevious:true},swfPath:pkrss.ajax.pkurlresurlpath+"js/third/jquery-jplayer",solution:"html,flash",supplied:"mp3,oga",wmode:"window"});var a=this;pkrss.q("#jpbtn_quickadd").on("click",function(){if(pkrss.plateform.runtime.apType==pkrss.plateform.runtime.aptype_pkradio){pkrss.event.trigger(pkrss.model.event.moreRssItem)}else{var h=a.playlist;var g,e,d=[];for(var f=0,j=h.playlist.length;f<j;++f){d["a"+h.playlist[f].artist]=1}for(var f=0,j=pkrss.model.rssitem.itemLength();f<j;++f){g=pkrss.model.rssitem.getItemByIndex(f);if(d["a"+g.id]){continue}d["a"+g.id]=1;e=pkrss.ajax.pkurlprefix+"/ttsservice/ajax/tts.ashx?task=tofile2&id="+g.id;h.add({title:g.title,oga:e+"&format=ogg",mp3:e+"&format=mp3",artist:g.id})}h._createItemHandlers()}});pkrss.q("#jpbtn_quickremove").on("click",function(){var c=a.playlist;c.setPlaylist([])});pkrss.q("#rssvoicecontainer").change(function(e){var f=pkrss.q("input[name=radio-mini-rssvoice]:checked");var d=pkrss.profile.usersetting.locale;var c=pkrss.profile.usersetting.locale2tts[d];if(f.length){c=f.val()}console.log("rssvoicecontainer.click oldlang:"+pkrss.profile.usersetting.locale2tts[d]+" newlang:"+c);if(pkrss.profile.usersetting.locale2tts[d]!=c){pkrss.profile.usersetting.locale2tts[d]=c;speaktts.setCurrentTTS(f.attr("class"),c);pksetting.saveUserData()}});pkrss.q("#navlist_0").text(pkgetLocaleString(pkrss.q("#navlist_0").text()));pkrss.q("#navlist_1").text(pkgetLocaleString(pkrss.q("#navlist_1").text()));if(pkrss.plateform.runtime.apType==pkrss.plateform.runtime.aptype_pkradio){pkrss.q("#jpbtn_quickadd").text("+ "+pkgetLocaleString("More"))}else{pkrss.q("#jpbtn_quickadd").text("+ "+pkgetLocaleString(pkrss.q("#jpbtn_quickadd").text()))}pkrss.q("#jpbtn_quickremove").text("X "+pkgetLocaleString(pkrss.q("#jpbtn_quickremove").text()));pkrss.q("#rssvoicelabel").text(pkgetLocaleString("Choose RSS voice:")+"("+pkgetLocaleString("System")+"+"+pkgetLocaleString("Internet")+")");pkrss.q("#settingPlaySupportNotificationSelectLabel").text(pkgetLocaleString(pkrss.q("#settingPlaySupportNotificationSelectLabel").text()));pkrss.q("#settingPlaySupportNotificationSelect > option").each(function(){var c=pkrss.q(this);c.text(pkgetLocaleString(c.text()))});var b=pkrss.q("#settingPlaySupportNotificationSelect");if(pkrss.notification&&pkrss.notification.browser_support_notification()){if(pkrss.profile.usersetting.notificationOnSpeak&&pkrss.notification.check_permission()){b[0].selectedIndex=1;pkrss.notification.init()}else{b.on("change",function(){pkrss.profile.usersetting.notificationOnSpeak=pkrss.q(this)[0].selectedIndex;pksetting.saveUserData()})}}else{b.attr("disabled","disabled")}pkrssspeak.event.bind(pkrssspeak.event.eventType.ended,function(){var c=a.playlist;if(c.current==c.playlist.length-3){pkrss2.morersscatalogitems()}},false)};pkrss.cls.newstype_plugincontainer_tts.prototype.init=function(){pkrss.utils.html.addCssFile(pkrss.ajax.pkurlresurlpath+"css/music/rssradio/webradio.css");var a=this;var b=[{ns:"pkrss.utils.tts",src:pkrss.ajax.pkurlresurlpath+"js/utils/tts.js"}];if(pkrss.plateform.isPhonegap){b.push({ns:"pkrss.utils.tts.phonegap",src:pkrss.ajax.pkurlresurlpath+"js/utils/tts/phonegap.js",depends:["pkrss.utils.tts"]})}b.push({ns:"pkrss.utils.tts.pkrss",src:pkrss.ajax.pkurlresurlpath+"js/utils/tts/pkrss.js",depends:["pkrss.utils.tts"]});b.push({ns:"jPlayerPlaylist",src:pkrss.ajax.pkurlresurlpath+"js/third/jquery-jplayer/add-on/pkplayer.playlist.js",depends:["pkrss.utils.tts"]});pkrss.utils.html.loadPlateformJs(b,function(c){if(!c){return}a.onJsLoaded();a=null})};pkrss.cls.newstype_plugincontainer_tts.prototype.getUserRssInfoById=function(c){for(var a in this.userrsslist){var b=this.userrsslist[a];if(b==c){return true}}return false};pkrss.cls.newstype_plugincontainer_tts.prototype.onBtnDownClicked=function(b){if(this.getUserRssInfoById(b)){return}var a=pkrsslib.getItemById(b);if(a){this.userrsslist.push(b)}pkrssspeak.downloadItemContent(b)};pkrss.cls.newstype_plugincontainer_tts.prototype.switchListTab=function(a){pkrss.q(".list_sel").removeClass("list_sel");pkrss.q("#navlist_"+a).addClass("list_sel");pkrss.q(".jp-playlist").hide();pkrss.q(".jp-pkpanel-"+a).show()};pkrss.cls.newstype_plugincontainer_tts.prototype.onRssLangChagned=function(){pkrss.utils.tts.getTTSList(this.ttscb)};pkrss.cls.newstype_plugincontainer_tts.prototype.addList=function(g){do{if(!pkrss.q("#content-pane-playerlist-item").length){if(this.playlist){this.playlist=null}break}var f=this.playlist;if(!f||!g||!g.length){break}for(var b=0,j=g.length;b<j;++b){var h=pttslist[b];var a=pkrss.ajax.pkwinurlprefix+"/ttsservice/ajax/tts.ashx?task=tofile2&id="+h;var e=pkrss.model.rssitem.getItemById(h);var d={title:e.title,oga:a+"&format=ogg",mp3:a+"&format=mp3",artist:h};f.add(d)}f._createItemHandlers()}while(false);do{if(0!=this.cur_navlist_idex){break}if(pkrss.q(".jp-playlist-item-desc").length>0){break}pkrss.q("#myplaylist ul li div").each(function(){var i=pkrss.q(this);if(!i.children(".jp-playlist-item-down").length){var k=i.find(".jp-artist").text();k=k.substring("by ".length);var c="";if(this.getUserRssInfoById(k)){c+="<span class='jp-playlist-item-down'>"+pkgetLocaleString("Downloaded")+"</span>"}else{c+="<a href='#' onclick='pkrss.model.newstype.plugincontainer.tts.onBtnDownClicked("+k+");' class='jp-playlist-item-down jp-playlist-item-btn'>"+pkgetLocaleString("Download")+"</a>"}i.append(c)}})}while(false)};pkrss.cls.newstype_plugincontainer_tts.prototype.ttscb=function(c){var a=pkrss.q("#rssvoicecontainer");a.empty();var b=pkrss.model.newstype.plugincontainer.tts._ttscb2(c,false);if(!b){b=pkrss.model.newstype.plugincontainer.tts._ttscb2(c,true)}if(b!=""){a.append(b)}a.trigger("create")};pkrss.cls.newstype_plugincontainer_tts.prototype._ttscb2=function(a,k){var g="";var c=pkrss.profile.usersetting.locale;for(var j in a){var h=a[j];var d=h.locale;if(k){d=pkrss.utils.tts._filterLocaleString(d);c=pkrss.utils.tts._filterLocaleString(c)}if(c!=d){continue}if(!h.tts||!h.tts.length){break}var e=0;var f=pkrss.profile.usersetting.locale2tts[c];if(f&&f!=""){for(var b in h.tts){var i=h.tts[b];if(i.id==f){e=b;break}}}for(var b in h.tts){var i=h.tts[b];g+='<input type="radio" class="rss-voice-'+i.group+'" id="rssvoice-radio-mini-'+b+'" name="radio-mini-rssvoice" value="'+i.id+'"'+(b==e?' checked="checked"':"")+" />";g+='<label for="rssvoice-radio-mini-'+b+'">'+pkgetLocaleString(i.group)+"-"+i.name+"</label>"}break}return g};pkrss.define("pkrss.model.newstype.plugincontainer",{tts:new pkrss.cls.newstype_plugincontainer_tts()});